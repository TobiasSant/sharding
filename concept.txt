Three-node sharding with replication and data persistence